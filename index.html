<!DOCTYPE html>  
<html lang="en">  
<head>  
  <meta charset="UTF-8" />  
  <title>EggScream ‚Äî The Screaming Chicken Beat</title>  
  <meta name="viewport" content="width=device-width, initial-scale=1" />  
  <style>  
    :root { --bg:#fff; --ink:#111; --muted:#666; }  
    html,body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}  
    .wrap{min-height:100dvh;display:flex;align-items:center;justify-content:center}  
    .inner{width:min(680px,92vw);text-align:center}  
    h1{margin:0 0 .4rem;font-size:clamp(28px,6vw,54px);font-weight:900;letter-spacing:-.02em}  
    p{margin:.25rem 0 0}  
    .muted{color:var(--muted);font-size:12px;margin-top:.6rem}  
    .btn{  
      display:inline-block;margin-top:1rem;padding:.9rem 1.2rem;border:1.5px solid #111;  
      color:#111;background:transparent;font-weight:900;letter-spacing:.02em;text-decoration:none;  
      cursor:pointer;user-select:none;transition:transform .06s ease, background .12s ease;  
    }  
    .btn:hover{background:#f2f2f2}  
    .btn:active{transform:translateY(1px)}  
    .flash{animation:flash .28s ease-in-out 1}  
    @keyframes flash{0%{background:#fff}50%{background:#fff6f6}100%{background:#fff}}  
    @media (prefers-reduced-motion:reduce){ .flash{animation:none} .btn{transition:none} }  
  </style>  
</head>  
<body>  
  <div class="wrap" id="stage">  
    <div class="inner">  
      <h1>chicken or egg?</h1>  
      <p><strong>neither. the scream came first.</strong></p>  
  
      <button id="btn" class="btn">üí•üêîü•ö 1$ MAKE IT SCREAM ‚Äî PLAY THE BEAT üí•üêîü•ö</button>  
  
      <p class="muted">Volume high. No refunds. Only scream.</p>  
    </div>  
  </div>  
  
  <script>  
  // ---------- Audio setup ----------  
  let ctx;  
  function ac(){  
    if(!ctx) ctx = new (window.AudioContext||window.webkitAudioContext)();  
    if(ctx.state==='suspended') ctx.resume();  
    return ctx;  
  }  
  function mkDist(c, amt=24){  
    const ws = c.createWaveShaper(), n=512, curve=new Float32Array(n);  
    for(let i=0;i<n;i++){ const x=i/n*2-1; curve[i]=Math.tanh(amt*x); }  
    ws.curve=curve; ws.oversample='4x'; return ws;  
  }  
  function flash(){  
    const stg = document.getElementById('stage');  
    stg.classList.remove('flash'); void stg.offsetWidth; stg.classList.add('flash');  
  }  
  
  // ---------- Drum blocks ----------  
  function kickPlop(c, t, out){  
    const o = c.createOscillator(); o.type='sine';  
    const g = c.createGain();  
    o.frequency.setValueAtTime(140, t);  
    o.frequency.exponentialRampToValueAtTime(55, t+0.16);  
    g.gain.setValueAtTime(0.9, t);  
    g.gain.exponentialRampToValueAtTime(0.0001, t+0.18);  
    o.connect(g).connect(out);  
    o.start(t); o.stop(t+0.19);  
    o.onended = ()=>{ try{o.disconnect(); g.disconnect();}catch(e){} };  
  
    const buf = c.createBuffer(1, Math.floor(c.sampleRate*0.12), c.sampleRate);  
    const d = buf.getChannelData(0); for(let i=0;i<d.length;i++) d[i]=Math.random()*2-1;  
    const n = c.createBufferSource(); n.buffer = buf;  
    const lp = c.createBiquadFilter(); lp.type='lowpass'; lp.frequency.value=220;  
    const ng = c.createGain(); ng.gain.setValueAtTime(0.7, t);  
    ng.gain.exponentialRampToValueAtTime(0.0001, t+0.14);  
    n.connect(lp).connect(ng).connect(out);  
    n.start(t); n.stop(t+0.14);  
    n.onended = ()=>{ try{n.disconnect(); lp.disconnect(); ng.disconnect();}catch(e){} };  
  }  
  function snareCluck(c, t, out){  
    const o = c.createOscillator(); o.type='square';  
    const g = c.createGain();  
    o.frequency.setValueAtTime(750, t);  
    o.frequency.exponentialRampToValueAtTime(300, t+0.07);  
    g.gain.setValueAtTime(0.85, t);  
    g.gain.exponentialRampToValueAtTime(0.0001, t+0.1);  
    o.connect(g).connect(out);  
    o.start(t); o.stop(t+0.11);  
    o.onended = ()=>{ try{o.disconnect(); g.disconnect();}catch(e){} };  
  
    const buf = c.createBuffer(1, Math.floor(c.sampleRate*0.11), c.sampleRate);  
    const d = buf.getChannelData(0); for(let i=0;i<d.length;i++) d[i]=Math.random()*2-1;  
    const n = c.createBufferSource(); n.buffer = buf;  
    const bp = c.createBiquadFilter(); bp.type='bandpass'; bp.frequency.value=3000; bp.Q.value=2.5;  
    const ng = c.createGain(); ng.gain.setValueAtTime(0.6, t);  
    ng.gain.exponentialRampToValueAtTime(0.0001, t+0.12);  
    n.connect(bp).connect(ng).connect(out);  
    n.start(t); n.stop(t+0.12);  
    n.onended = ()=>{ try{n.disconnect(); bp.disconnect(); ng.disconnect();}catch(e){} };  
  }  
  function hatClick(c, t, out){  
    const buf = c.createBuffer(1, Math.floor(c.sampleRate*0.05), c.sampleRate);  
    const d = buf.getChannelData(0); for(let i=0;i<d.length;i++) d[i]=(Math.random()*2-1)*0.9;  
    const n = c.createBufferSource(); n.buffer = buf;  
    const hp = c.createBiquadFilter(); hp.type='highpass'; hp.frequency.value=5000;  
    const g = c.createGain(); g.gain.setValueAtTime(0.35, t);  
    g.gain.exponentialRampToValueAtTime(0.0001, t+0.05);  
    n.connect(hp).connect(g).connect(out);  
    n.start(t); n.stop(t+0.06);  
    n.onended = ()=>{ try{n.disconnect(); hp.disconnect(); g.disconnect();}catch(e){} };  
  }  
  
  // ---------- Scream (3s) ----------  
  function chickenScream3s(c, t, out){  
    flash();  
    const len = 3.0;  
    const bus = c.createGain(); bus.gain.value = 0.85;  
    const dist = mkDist(c, 20);  
    const bp = c.createBiquadFilter(); bp.type='bandpass'; bp.frequency.value=1800; bp.Q.value=4.5;  
    const lp = c.createBiquadFilter(); lp.type='lowpass'; lp.frequency.value=2800;  
    bus.connect(dist).connect(bp).connect(lp).connect(out);  
  
    [-10,+10].forEach(det => {  
      const o = c.createOscillator(); o.type='sawtooth';  
      const g = c.createGain();  
      o.frequency.setValueAtTime(620, t);  
      o.detune.setValueAtTime(det, t);  
      o.frequency.linearRampToValueAtTime(720, t+0.12);  
      o.frequency.exponentialRampToValueAtTime(150, t+len*0.92);  
  
      g.gain.setValueAtTime(0.0001, t);  
      g.gain.exponentialRampToValueAtTime(0.95, t+0.06);  
      g.gain.exponentialRampToValueAtTime(0.0001, t+len);  
  
      const trem = c.createOscillator(); trem.frequency.value = 13;  
      const tremAmt = c.createGain(); tremAmt.gain.value = 0.7;  
      trem.connect(tremAmt.gain); g.connect(tremAmt);  
  
      o.connect(g).connect(bus);  
      trem.start(t); trem.stop(t+len);  
      o.start(t); o.stop(t+len);  
    });  
  
    const nbuf = c.createBuffer(1, Math.floor(c.sampleRate*len), c.sampleRate);  
    const d = nbuf.getChannelData(0); for(let i=0;i<d.length;i++) d[i]=Math.random()*2-1;  
    const n = c.createBufferSource(); n.buffer = nbuf;  
    const nBP = c.createBiquadFilter(); nBP.type='bandpass'; nBP.frequency.value=2600; nBP.Q.value=6;  
    const ng = c.createGain();  
    ng.gain.setValueAtTime(0.001, t+0.08);  
    ng.gain.exponentialRampToValueAtTime(0.5, t+0.22);  
    ng.gain.exponentialRampToValueAtTime(0.0001, t+len);  
    n.connect(nBP).connect(ng).connect(bus);  
    n.start(t); n.stop(t+len);  
  
    setTimeout(()=>{ try{bus.disconnect(); dist.disconnect(); bp.disconnect(); lp.disconnect();}catch(e){} }, (len+0.2)*1000);  
    return t + len;  
  }  
  
  // ---------- Beat (2s) ----------  
  function scheduleBeat2s(c, start, out){  
    const dur = 2.0;  
    const beat = 0.5; // 120 BPM (quarter = 0.5s)  
    for(let i=0;i<4;i++){  
      const t = start + i*beat;  
      if(i===0 || i===2) kickPlop(c, t, out); else snareCluck(c, t, out);  
      hatClick(c, t, out);  
      hatClick(c, t + beat/2, out);  
    }  
    return start + dur;  
  }  
  
  // ---------- Alternanza: 3s scream -> 2s beat -> loop ----------  
  let loopTimer = null, cleanup = null;
  let isPlaying = false; // toggle stato
  
  function playAlternating(){  
    const c = ac();  
    if (cleanup) { try{ cleanup(); }catch(e){} cleanup = null; }  
  
    const master = c.createGain(); master.gain.value = 0.95;  
    const softLim = mkDist(c, 12);  
    const comp = c.createDynamicsCompressor();  
    comp.threshold.value = -10; comp.knee.value = 8; comp.ratio.value = 6; comp.attack.value = 0.002; comp.release.value = 0.06;  
    master.connect(softLim).connect(comp).connect(c.destination);  
  
    const PERIOD = 5.0; // 3s urlo + 2s beat  
    let base = c.currentTime + 0.03;  
  
    const afterScream = chickenScream3s(c, base, master); // 3.0s  
    scheduleBeat2s(c, afterScream + 0.05, master);        // 2.0s  
  
    loopTimer = setInterval(()=>{  
      base += PERIOD;  
      const endS = chickenScream3s(c, base, master);  
      scheduleBeat2s(c, endS + 0.05, master);  
    }, PERIOD * 1000);  
  
    cleanup = () => {  
      try{ clearInterval(loopTimer); }catch(e){}  
      loopTimer = null;  
      try{ master.disconnect(); softLim.disconnect(); comp.disconnect(); }catch(e){}  
      try{ c.suspend(); }catch(e){}  
    };
    isPlaying = true;
    btn.textContent = "üõë STOP THE SCREAM";
  }
  function stopAlternating(){
    if (cleanup) { try{ cleanup(); }catch(e){} }
    cleanup = null;
    isPlaying = false;
    btn.textContent = "üí•üêîü•ö 1$ MAKE IT SCREAM ‚Äî PLAY THE BEAT üí•üêîü•ö";
  }
  
  // --------- UI: toggle start/stop ----------
  const btn = document.getElementById('btn');
  btn.addEventListener('click', () => {
    if (!isPlaying) playAlternating();
    else           stopAlternating();
  });  
  </script>  
</body>  
</html>


















